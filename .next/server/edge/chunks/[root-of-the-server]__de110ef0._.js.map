{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst CSRF_HEADER = 'x-csrf-token';\r\nconst CSRF_COOKIE = '__Host-next-auth.csrf-token';\r\n\r\nexport function middleware(req: NextRequest) {\r\n  // Set security headers for all responses\r\n  const res = NextResponse.next();\r\n  res.headers.set('X-Frame-Options', 'SAMEORIGIN');\r\n  res.headers.set('X-Content-Type-Options', 'nosniff');\r\n  res.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\r\n  res.headers.set('Permissions-Policy', 'geolocation=(), microphone=()');\r\n  res.headers.set('Strict-Transport-Security', 'max-age=63072000; includeSubDomains; preload');\r\n\r\n  // Only check CSRF for sensitive API routes\r\n  if (\r\n    ((req.nextUrl.pathname.startsWith('/api/order') || req.nextUrl.pathname.startsWith('/api/user')) &&\r\n      (req.method === 'POST' || req.method === 'PUT' || req.method === 'DELETE'))\r\n  ) {\r\n    const csrfHeader = req.headers.get(CSRF_HEADER);\r\n    const csrfCookie = req.cookies.get(CSRF_COOKIE)?.value;\r\n    if (!csrfHeader || !csrfCookie || csrfHeader !== csrfCookie) {\r\n      return NextResponse.json({ error: 'Invalid CSRF token' }, { status: 403 });\r\n    }\r\n  }\r\n\r\n  return res;\r\n}\r\n\r\nexport const config = {\r\n  matcher: ['/api/order/:path*', '/api/user/:path*', '/dashboard/:path*'],\r\n}; "],"names":[],"mappings":";;;;AAAA;AAAA;;AAEA,MAAM,cAAc;AACpB,MAAM,cAAc;AAEb,SAAS,WAAW,GAAgB;IACzC,yCAAyC;IACzC,MAAM,MAAM,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC7B,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACnC,IAAI,OAAO,CAAC,GAAG,CAAC,0BAA0B;IAC1C,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACnC,IAAI,OAAO,CAAC,GAAG,CAAC,sBAAsB;IACtC,IAAI,OAAO,CAAC,GAAG,CAAC,6BAA6B;IAE7C,2CAA2C;IAC3C,IACG,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,iBAAiB,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,YAAY,KAC7F,CAAC,IAAI,MAAM,KAAK,UAAU,IAAI,MAAM,KAAK,SAAS,IAAI,MAAM,KAAK,QAAQ,GAC3E;QACA,MAAM,aAAa,IAAI,OAAO,CAAC,GAAG,CAAC;QACnC,MAAM,aAAa,IAAI,OAAO,CAAC,GAAG,CAAC,cAAc;QACjD,IAAI,CAAC,cAAc,CAAC,cAAc,eAAe,YAAY;YAC3D,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC1E;IACF;IAEA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAqB;QAAoB;KAAoB;AACzE"}}]
}